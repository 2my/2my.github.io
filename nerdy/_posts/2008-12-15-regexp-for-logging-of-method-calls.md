---
title: "Regexp for logging of method calls"
layout: "post"
permalink: "/2008/12/regexp-for-logging-of-method-calls.html"
uuid: "1879759498528346276"
guid: "tag:blogger.com,1999:blog-7706585097329252419.post-1879759498528346276"
date: "2008-12-15 15:16:00"
updated: "2009-11-16 10:30:26"
description: 
blogger:
    siteid: "7706585097329252419"
    postid: "1879759498528346276"
    comments: "0"
categories: [testing]
author: 
    name: "Tommy"
    url: "http://www.blogger.com/profile/16604372255669213767?rel=author"
    image: "http://static.flickr.com/93/279356255_fb52db20a0_o.jpg"
---

<div class="css-full-post-content js-full-post-content">
<span style="font-size:130%;">BeanShell macros</span> (May be run in jEdit)<br />Copy and paste auto-generated method signature, and run this macro<br /><pre><br />// rid of tabs, newlines and double spaces<br />strippSpace( String text ) {<br /> text    = text.replaceAll( "\\t" , " " );<br /> text    = text.replaceAll( "\\n?" , "" );<br /> do {<br />     text    = text.replaceAll( "  " , " " );<br /> } while ( text.indexOf( "  " ) > -1 );<br /> return text;<br />}<br /><br />// tidy up method call<br />cleanCall( String text ) {<br /> text    = text.replaceAll( "\\(\\s*" , "(\n\t" );<br /> text    = text.replaceAll( ",\\s*" , ",\n\t" );<br /> text    = text.replaceAll( "\\s*\\)\\s*" , "\n)" );<br /> return text;<br />}<br /><br />convertMethodSignature2SuperCall( String text ){<br /> // 2 strings before )<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*\\)\\W*" , "$1 );" );<br /> // 2 strings before comma<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*,\\W*" , "$1, " );<br /> // 3 strings before (<br /> text    = text.replaceAll( "\\A\\s*\\w*\\s?void\\s?(\\w*)\\s*\\(" , "super.$1(" );<br /> text    = text.replaceAll( "\\A\\s*\\w*\\s?\\w*\\s?(\\w*)\\s*\\(" , "return super.$1(" );<br /> return text;<br />}<br /><br />convertMethodSignature2SillyReturn( String text ){<br /> // 2 strings before )<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*\\)\\W*" , "$1 );" );<br /> // 2 strings before comma<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*,\\W*" , "$1, " );<br /> // 3 strings before (<br /> text    = text.replaceAll( "\\A\\s*\\w*\\s?void\\s?(\\w*)\\s*\\(" , "" );<br /> text    = text.replaceAll( "\\A\\s*\\w*\\s?(\\w*)\\s?(\\w*)\\s*\\(" , "return new $1();" );<br /> return text;<br />}<br /><br />convertMethodSignature2LogStatement( String text ){<br /> // 2 strings before )<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*\\)\\W*" , "\n\t\tSEMAFOR_CALL \"$1\" SEMAFOR_COMMA $1 )\n\t);" );<br /> // 2 strings before comma<br /> text    = text.replaceAll( "\\w*\\W?(\\w*)\\W*,\\W*" , "\n\t\tSEMAFOR_CALL \"$1\" SEMAFOR_COMMA $1 )," );<br /> // 3 strings before parenthesis<br /> text    = text.replaceAll( "\\A\\s*\\w*\\s?\\w*\\s?(\\w*)\\(" , "\tSEMAFOR_CALL \"$1\" ," );<br /> // semafors<br /> text    = text.replaceAll( "SEMAFOR_COMMA" , "," );<br /> text    = text.replaceAll( "SEMAFOR_CALL" , "toXml(" );<br /> return text;<br />}<br /><br />String text = Macros.input(view,"Method call:");<br />if(text == null || "".equals(text))<br /> return;<br /><br />String text    = strippSpace( text );<br />String superCall    = convertMethodSignature2SuperCall( text );<br />String logCall    = convertMethodSignature2LogStatement( text );<br />String call    = cleanCall( text );<br />String res    = call + "{\n" + logCall + "\n\t" + superCall + "\n}";<br /><br />Registers.setRegister('HistoryModel.getModel("clipboard").addItem(res);<br />view.getStatus().setMessageAndClear("OK - result on clipboard");<br /></pre><br /><br /><span style="font-size:130%;">Logging methods</span><br /><pre><br />public static String toXml( String name, Object value ) {<br />// FixMe: escape xml special characters<br />if ( value == null )<br />   value    = "";<br />return "\t<" + name + ">" + value.toString() + "<!--" + name + "-->";<br />}<br />/**  */<br />public static String toXml( String method, String... items ) {<br />String msg    = "";<br />if ( items != null &amp;&amp; 0 < msg    = "<">" + msg + "<!--" + method + "-->";<br />System.out.println( msg );<br />return msg;<br />},res);<br />HistoryModel.getModel("clipboard").addItem(res);<br />view.getStatus().setMessageAndClear("OK - result on clipboard");<br /><br /><span style="font-size:130%;">Logging methods</span><br />public static String toXml( String name, Object value ) {<br />// FixMe: escape xml special characters<br />if ( value == null )<br />   value    = "";<br />return "\t<" + name + ">" + value.toString() + "<!--" + name + "-->";<br />}<br />/**  */<br />public static String toXml( String method, String... items ) {<br />String msg    = "";<br />if ( items != null &amp;&amp; 0 < msg    = "<">" + msg + "<!--" + method + "-->";<br />System.out.println( msg );<br />return msg;<br />}<br /></pre>
</div>